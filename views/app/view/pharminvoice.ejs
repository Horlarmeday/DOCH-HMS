<% include ../../partials/header %>
<% include ../../partials/sidebarCopy %>


<div class="pcoded-content">
        <div class="pcoded-inner-content">
            <!-- Main-body start -->
            <div class="main-body">
                <div class="page-wrapper">
                    <!-- Page body start -->
                    <div class="page-body">
                        <!-- Container-fluid starts -->
                        <div class="container">
                            <!-- Main content starts -->
                            <div>
                                <!-- Invoice card start -->
                                <div class="card printableArea">
                                    <div class="row invoice-contact">
                                        <div class="col-md-12">
                                            <div class="invoice-box row">
                                                <div class="col-sm-12">
                                                    <table style="display: inline" class="table table-responsive invoice-table table-borderless">
                                                        <tbody>
                                                            <tr>
                                                                <th></th>
                                                                <td>Daughter of Charity Hospital</td>
                                                            </tr>
                                                            <tr>
                                                                <th></th>
                                                                <td>Train Station, Opposite Kubwa</td>
                                                            </tr>
                                                            <tr>
                                                                <th></th>
                                                                <td><a href="mailto:info@doch.com.ng" target="_top">info@doch.com.ng</a>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <th></th>
                                                                <td>+91 919-91-91-919</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                    <img style="border-radius: 50%" src="/assets/images/charitylogo.png" width="70" class="float-right mr-5" alt="">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-block">
                                        <div class="row invoive-info">
                                            <div class="col-md-4 col-xs-12 invoice-client-info">
                                                <h6>Client Information :</h6>
                                                <h6 class="m-0"><%= consultation.patient.firstname %> <%= consultation.patient.lastname %></h6>
                                                <p class="m-0 m-t-10"><%= consultation.patient.address %></p>
                                                <p class="m-0"><%= consultation.patient.phonenumber %></p>
                                                <p><%= consultation.patient.email %></p>
                                            </div>
                                            <div class="col-md-4 col-sm-6">
                                                <h6>Order Information :</h6>
                                                <table class="table table-responsive invoice-table invoice-order table-borderless">
                                                    <tbody>
                                                        <tr>
                                                            <th>Date :</th>
                                                            <td><%= consultation.patient.createdAt.toLocaleString('en-US') %></td>
                                                        </tr>
                                                        <tr>
                                                            <th>Status :</th>
                                                            <td>
                                                                <% if(!consultation.labpaid){ %>
                                                                    <span class="label label-warning">Pending</span>
                                                                <% }else{ %>
                                                                    <span class="label label-success">Paid</span>
                                                                <% } %>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th>Id :</th>
                                                            <td>
                                                                #145698
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <%
                                            function getSum(total, num) {
                                                return total + num;
                                            }
                                            const totalDrugPrice = consultation.drugsObject.map(price =>{
                                                const rPrice = price.sellprice
                                                return rPrice;
                                                               
                                            })
                                            var totalAmount;
                                            if(totalDrugPrice === undefined || totalDrugPrice.length == 0){
                                                totalAmount = 0
                                            }else{
                                                totalAmount = totalDrugPrice.reduce(getSum)
                                            }
                                            
                                        %>
                                            <div class="col-md-4 col-sm-6">
                                                <h6 class="m-b-20">Invoice Number   <span>#12398521473</span></h6>
                                                <h6 class="text-uppercase text-primary">Total:
                                                    <span>&#8358;<%= totalAmount %></span>
                                                </h6>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-12">
                                                <div class="table-responsive">
                                                    <table class="table invoice-detail-table">
                                                        <thead>
                                                            <tr class="thead-default">
                                                                <th>S/N</th>
                                                                <th>Drugs</th>
                                                                <th>Amount (&#8358;)</th>
                                                                <th>Total (&#8358;)</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                                <% consultation.drugsObject.forEach((test)=>{ %>
                                                            <tr>
                                                                <td></td>
                                                                <td><%= test.name %></td>
                                                                <td><%= test.sellprice %></td>
                                                                <td><%= test.sellprice %></td>
                                                            </tr>
                                                            <% }) %>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="row">
                                            <div class="col-sm-12">
                                                <div class="">
                                                    <table class="table invoice-table invoice-total table-responsive">
                                                    <tbody>
                                                        <!-- <tr>
                                                            <th>Sub Total :</th>
                                                            <td>$4725.00</td>
                                                        </tr>
                                                        <tr>
                                                            <th>Taxes (10%) :</th>
                                                            <td>$57.00</td>
                                                        </tr>
                                                        <tr>
                                                            <th>Discount (5%) :</th>
                                                            <td>$45.00</td>
                                                        </tr> -->
                                                        <tr class="text-info">
                                                                <th></th>
                                                            <td>
                                                                <hr/>
                                                                <h5 class="text-primary">Total  :</h5>
                                                            </td>
                                                            <td>
                                                                <hr/>
                                                                <h5 class="text-primary">&#8358;<%= totalAmount %></h5>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                       
                                    </div>
                                </div>
                                <!-- Invoice card end -->
                                <div class="row">
                                        <!-- <div class="col-sm-12">
                                            <h6>Terms And Condition :</h6>
                                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor </p>
                                        </div> -->
                                        <div class="col-sm-12 invoice-btn-group">
                                            <button id="print" type="button" class="btn btn-primary btn-print-invoice waves-effect waves-light m-r-20 m-b-10">Print Invoice
                                            </button>
                                            <a href="/dashboard" class="btn btn-danger waves-effect waves-light m-b-10">Cancel Invoice
                                            </a>
                                        </div>
                                    </div>
                            </div>
                        </div>
                        <!-- Container ends -->
                    </div>
                    <!-- Page body end -->
                </div>
            </div>
            <!-- Warning Section Starts -->

            <!-- <div id="styleSelector">

            </div> -->
        </div>
    </div>

<% include ../../partials/footerCopy %>